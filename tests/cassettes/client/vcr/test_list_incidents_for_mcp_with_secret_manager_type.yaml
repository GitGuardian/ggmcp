interactions:
- request:
    body: ''
    headers:
      Accept:
      - '*/*'
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      Content-Type:
      - application/json
      Host:
      - api.gitguardian.com
      User-Agent:
      - GitGuardian-MCP-Server/1.0
    method: GET
    uri: https://api.gitguardian.com/v1/incidents-for-mcp?page=1&page_size=5&secret_manager_type__in=hashicorpvault%2Cawssecretsmanager
  response:
    body:
      string: '{"count": 4, "page": 1, "next": null, "previous": null, "results":
        [{"id": 21537872, "account": 8, "criterion": "AWS Keys", "date": "2025-05-06T13:30:40Z",
        "last_trigger_published_at": "2025-05-06T13:30:40Z", "last_triggered_at":
        "2025-10-10T21:51:39.656900Z", "last_trigger_detected_at": "2025-10-10T21:51:39.656900Z",
        "hash": "cbyxqpAjYKG6B6pIofNchCFpgjht/BnnaICdGlk1rgdxrm2VL4Qc71cZRqNcojMG",
        "policy": 1, "ignored": true, "ignored_at": "2025-10-10T21:51:39.672073Z",
        "ignore_reason": "invalid", "ignorer": 491414, "resolved": false, "resolved_at":
        null, "resolver": null, "regression": false, "manual_severity_setter": null,
        "policy_name": "ensure_no_secrets", "policy_display_name": "Secrets detection",
        "ignorer_display_name": "8@bot.gitguardian.com", "ignorer_type": "user", "resolver_display_name":
        "none", "resolver_type": "none", "manual_severity_setter_display_name": "none",
        "manual_severity_setter_type": "none", "status": "IGNORED", "issue_name":
        "AWS IAM Keys", "severity_rule_config": null, "declarative_secret_status":
        "invalid", "assignee": null, "last_presence_check_at": null, "secret": "[REDACTED]",
        "severity": 100, "authors": [{"info": "mathias.millet@gitguardian.com", "name":
        "Mathias Millet"}], "user_permission": 7, "is_publicly_shared": false, "feedbacks_count":
        0, "occurrences_presence_seen_count": 1, "occurrences_presence_deleted_count":
        0, "occurrences_presence_should_be_checked": null, "locations_count": 1, "sources":
        [{"name": "mathias millet / test-realtime", "type": "gl_project", "path":
        "mmillet/test-realtime", "source_criticality": "unknown"}], "custom_tags":
        [], "vault_metadata": [{"source": "awssecretsmanager"}], "is_vaulted": true,
        "similar_issue_count": 0, "score": 7, "displayed_occurrence": {"id": 219702250,
        "issue": 21537872, "account": 8, "kind": "HIST", "element": "0fbf5048185b219b68415ee491be9b959cc05ebd",
        "element_type": "GIT_COMMIT", "author_name": "Mathias Millet", "author_info":
        "mathias.millet@gitguardian.com", "value": null, "value_hash": "tbL/37FIqWG5eM10TSd/993Dy0wZkL8cgSGYbt1ueLX0q3dbh7q3gEg/RXNDnzPJ",
        "published_at": "2025-05-06T13:30:40Z", "date": "2025-05-06T13:30:40Z", "detected_at":
        "2025-10-10T21:51:36.414746Z", "is_vcs_type": true, "last_detected_at": "2025-05-06T13:30:40Z",
        "last_seen_at": "2025-05-06T13:30:40Z", "data": {}, "url": "https://gitlab-01.aws-qa-gitguardian.com/mmillet/test-realtime/commit/0fbf5048185b219b68415ee491be9b959cc05ebd#8c984c0aec6bbbe7157a1e5c4df1764ddd9ee83c_7_6",
        "source": {"id": 23485699, "url": "https://gitlab-01.aws-qa-gitguardian.com/mmillet/test-realtime",
        "type": "gl_project", "display_name": "mathias millet / test-realtime", "visibility":
        "internal", "monitored": true, "source_criticality": "unknown", "deleted_at":
        null, "default_branch": "main"}, "regression": false, "content": 98398797,
        "secrets_engine_version": "2.148.0", "matches": [{"name": "client_secret",
        "string_matched": "[REDACTED]", "indice_start": 169, "indice_end": 209, "pre_line_start":
        null, "pre_line_end": null, "post_line_start": 6, "post_line_end": 6}, {"name":
        "client_id", "string_matched": "[REDACTED]", "indice_start": 55, "indice_end":
        75, "pre_line_start": 5, "pre_line_end": 5, "post_line_start": 5, "post_line_end":
        5}], "most_sensitive_match_name": "client_secret", "insights": [], "filepath":
        "aws_iam", "filename": "aws_iam", "presence": "visible", "last_presence_seen_at":
        "2025-10-24T13:55:26.014169Z", "last_presence_check_at": "2025-10-24T13:55:26.014169Z",
        "first_presence_deleted_at": null, "seen_in_default_branch": true, "change_type":
        "addition", "full_tags": [{"type": "FROM_HISTORICAL_SCAN", "metadata": null},
        {"type": "DEFAULT_BRANCH", "metadata": null}]}, "has_dropped_occurrences":
        false, "tags": ["DEFAULT_BRANCH", "FROM_HISTORICAL_SCAN"], "public_exposure":
        {"source_publicly_visible": false, "public_incident_linked": false, "leaked_outside_perimeter":
        false}, "occurrences_count": 1}, {"id": 15154672, "account": 8, "criterion":
        "GitLab OAuth Application Token", "date": "2025-01-13T09:55:09Z", "last_trigger_published_at":
        "2025-01-13T09:55:09Z", "last_triggered_at": "2025-01-13T09:59:52.011211Z",
        "last_trigger_detected_at": "2025-01-13T09:59:52.011211Z", "hash": "4g5/yEr5XshVtZHKqFi1E9yX6MX4TpW8xvREMb0ijkeY9HRiDKw0Wt0HegDxFpeb",
        "policy": 1, "ignored": false, "ignored_at": null, "ignore_reason": null,
        "ignorer": null, "resolved": false, "resolved_at": null, "resolver": null,
        "regression": false, "manual_severity_setter": null, "policy_name": "ensure_no_secrets",
        "policy_display_name": "Secrets detection", "ignorer_display_name": "none",
        "ignorer_type": "none", "resolver_display_name": "none", "resolver_type":
        "none", "manual_severity_setter_display_name": "none", "manual_severity_setter_type":
        "none", "status": "TRIGGERED", "issue_name": "GitLab OAuth Application Token",
        "severity_rule_config": {"id": 10289, "gg_created_at": "2025-11-05T13:08:54.487518Z",
        "gg_updated_at": "2025-11-05T13:08:54.487521Z", "index": 160, "severity":
        20, "rule": {"id": 574, "gg_created_at": "2025-06-13T16:15:20.466677Z", "gg_updated_at":
        "2025-06-13T16:15:20.466692Z", "name": "VCS Creds", "description": null, "json_rule":
        {"operator": "AND", "args": [{"operator": "EQ", "arg1": {"path": "issue.secret.detector.metadata.category",
        "default": null}, "arg2": {"value": "version_control_platform"}}, {"operator":
        "NOT", "arg1": {"operator": "EQ", "arg1": {"path": "issue.secret.validity_status",
        "default": null}, "arg2": {"value": "invalid"}}}]}, "is_global": false, "scope":
        "private", "author": 520858}}, "declarative_secret_status": "active", "assignee":
        null, "last_presence_check_at": null, "secret": "[REDACTED]", "severity":
        100, "authors": [{"info": "jonathan.griffe@gitguardian.com", "name": "Jonathan
        Griffe"}], "user_permission": 7, "is_publicly_shared": false, "feedbacks_count":
        1, "occurrences_presence_seen_count": 1, "occurrences_presence_deleted_count":
        0, "occurrences_presence_should_be_checked": null, "locations_count": 0, "sources":
        [{"name": "SorunEngineering/sample_secrets_reboot_jgriffe", "type": "gh_repository",
        "path": "SorunEngineering/sample_secrets_reboot_jgriffe", "source_criticality":
        "unknown"}], "custom_tags": [], "vault_metadata": [{"source": "awssecretsmanager"}],
        "is_vaulted": true, "similar_issue_count": 0, "score": 40, "displayed_occurrence":
        {"id": 175387595, "issue": 15154672, "account": 8, "kind": "HIST", "element":
        "1be27069440b2d3602e7acbb01119682c71a28a2", "element_type": "GIT_COMMIT",
        "author_name": "Jonathan Griffe", "author_info": "jonathan.griffe@gitguardian.com",
        "value": null, "value_hash": "pn66tDeLb8RUJykrU9sQcfK7ssdyB6fVC+gwD986lUrocSEuQpAQ0DC8oymEIoEt",
        "published_at": "2025-01-13T09:55:09Z", "date": "2025-01-13T09:55:09Z", "detected_at":
        "2025-01-13T09:55:59.895460Z", "is_vcs_type": true, "last_detected_at": "2025-01-13T09:55:55.173084Z",
        "last_seen_at": "2025-01-13T09:55:55.173084Z", "data": {}, "url": "https://github.com/SorunEngineering/sample_secrets_reboot_jgriffe/commit/1be27069440b2d3602e7acbb01119682c71a28a2#diff-2dd750ad8ef31466e2c0a051bca31ed22074eda13a85e6901fbd0534c9a8a960R1",
        "source": {"id": 18158390, "url": "https://github.com/SorunEngineering/sample_secrets_reboot_jgriffe",
        "type": "gh_repository", "display_name": "SorunEngineering/sample_secrets_reboot_jgriffe",
        "visibility": "private", "monitored": false, "source_criticality": "unknown",
        "deleted_at": "2025-01-17T08:50:03.494741Z", "default_branch": "main"}, "regression":
        false, "content": 47586211, "secrets_engine_version": "2.129.1", "matches":
        [{"name": "apikey", "string_matched": "[REDACTED]", "indice_start": 80, "indice_end":
        150, "pre_line_start": null, "pre_line_end": null, "post_line_start": 1, "post_line_end":
        1}], "most_sensitive_match_name": "apikey", "insights": [{"name": "test_file",
        "source": "document", "metadata": null}], "filepath": "true_positives/specific/gitlab_oauth_application_token/example3.conf",
        "filename": "example3.conf", "presence": "visible", "last_presence_seen_at":
        "2025-01-14T09:21:35.676100Z", "last_presence_check_at": "2025-01-14T09:21:35.676100Z",
        "first_presence_deleted_at": null, "seen_in_default_branch": null, "change_type":
        "addition", "full_tags": [{"type": "FROM_HISTORICAL_SCAN", "metadata": null},
        {"type": "TEST_FILE", "metadata": null}]}, "has_dropped_occurrences": false,
        "tags": ["FROM_HISTORICAL_SCAN", "TEST_FILE"], "public_exposure": {"source_publicly_visible":
        false, "public_incident_linked": false, "leaked_outside_perimeter": false},
        "occurrences_count": 1}, {"id": 10539115, "account": 8, "criterion": "Google
        API Key", "date": "2023-08-16T04:51:31Z", "last_trigger_published_at": "2023-08-16T04:51:31Z",
        "last_triggered_at": "2024-04-25T13:00:14.088072Z", "last_trigger_detected_at":
        "2024-04-25T13:00:14.088072Z", "hash": "R7fx2m96jLJ3avssp39BjUKFcwOEuRcTaqkJMRuzHEv7ZKF/iwQ5Z8PP16EaJtIX",
        "policy": 1, "ignored": false, "ignored_at": null, "ignore_reason": null,
        "ignorer": null, "resolved": false, "resolved_at": null, "resolver": null,
        "regression": false, "manual_severity_setter": null, "policy_name": "ensure_no_secrets",
        "policy_display_name": "Secrets detection", "ignorer_display_name": "none",
        "ignorer_type": "none", "resolver_display_name": "none", "resolver_type":
        "none", "manual_severity_setter_display_name": "none", "manual_severity_setter_type":
        "none", "status": "ASSIGNED", "issue_name": "Google API Key", "severity_rule_config":
        {"id": 7264, "gg_created_at": "2025-03-18T08:57:54.146724Z", "gg_updated_at":
        "2025-03-18T08:57:54.146727Z", "index": 3, "severity": 10, "rule": {"id":
        504, "gg_created_at": "2025-03-18T08:57:54.142094Z", "gg_updated_at": "2025-03-18T08:57:54.142100Z",
        "name": "Valid secrets for cloud providers", "description": "Secrets tied
        to cloud providers were valid when the incident was discovered", "json_rule":
        {"operator": "AND", "args": [{"operator": "EQ", "arg1": {"path": "issue.secret.validity_status",
        "default": null}, "arg2": {"value": "valid"}}, {"operator": "EQ", "arg1":
        {"path": "issue.secret.detector.metadata.category", "default": null}, "arg2":
        {"value": "cloud_provider"}}]}, "is_global": true, "scope": "any", "author":
        null}}, "declarative_secret_status": null, "assignee": 104371, "last_presence_check_at":
        null, "secret": "[REDACTED]", "severity": 100, "authors": [{"info": "117423508+pre-commit-ci-lite[bot]@users.noreply.github.com",
        "name": "pre-commit-ci-lite[bot]"}, {"info": "35215270+CalcoastWineries@users.noreply.github.com",
        "name": "CalcoastWineries"}, {"info": "jeroenwillemsen2001@gmail.com", "name":
        "Jeroen Willemsen"}, {"info": "noreply@github.com", "name": "GitHub"}, {"info":
        "ubuntu@ip-172-31-20-198.us-east-2.compute.internal", "name": "Ubuntu"}],
        "user_permission": 7, "is_publicly_shared": false, "feedbacks_count": 0, "occurrences_presence_seen_count":
        8, "occurrences_presence_deleted_count": 0, "occurrences_presence_should_be_checked":
        null, "locations_count": 0, "sources": [{"name": "CalcoastWineries/sample_secrets",
        "type": "gh_repository", "path": "CalcoastWineries/sample_secrets", "source_criticality":
        "unknown"}, {"name": "ferdi05/wrongsecrets", "type": "gh_repository", "path":
        "ferdi05/wrongsecrets", "source_criticality": "critical"}, {"name": "SorunEngineering/wrongsecrets",
        "type": "gh_repository", "path": "SorunEngineering/wrongsecrets", "source_criticality":
        "unknown"}], "custom_tags": [], "vault_metadata": [{"source": "hashicorpvault"}],
        "is_vaulted": true, "similar_issue_count": 0, "score": 20, "displayed_occurrence":
        {"id": 131090380, "issue": 10539115, "account": 8, "kind": "HIST", "element":
        "92740436df98d0d100f4c6457a9fb58199958fbc", "element_type": "GIT_COMMIT",
        "author_name": "Jeroen Willemsen", "author_info": "jeroenwillemsen2001@gmail.com",
        "value": null, "value_hash": "D/+a9KCurumR9DyG1sHH6agWZswqMsvwkxid5uD63nUw/X3scoCgBqH2RJLkUt3A",
        "published_at": "2023-08-16T04:51:31Z", "date": "2023-08-16T04:51:31Z", "detected_at":
        "2024-04-25T13:00:03.000790Z", "is_vcs_type": true, "last_detected_at": "2025-09-11T09:59:04.048932Z",
        "last_seen_at": "2025-09-11T09:59:04.048932Z", "data": {}, "url": "https://github.com/ferdi05/wrongsecrets/commit/92740436df98d0d100f4c6457a9fb58199958fbc#diff-90bc96a8a465819590c22969bc1a77ecbbf8e8fe06e30227a471c86eee154e47R67",
        "source": {"id": 13926492, "url": "https://github.com/ferdi05/wrongsecrets",
        "type": "gh_repository", "display_name": "ferdi05/wrongsecrets", "visibility":
        "public", "monitored": true, "source_criticality": "critical", "deleted_at":
        null, "default_branch": "master"}, "regression": false, "content": 31269568,
        "secrets_engine_version": "2.111.0", "matches": [{"name": "apikey", "string_matched":
        "[REDACTED]", "indice_start": 1779, "indice_end": 1818, "pre_line_start":
        null, "pre_line_end": null, "post_line_start": 67, "post_line_end": 67}],
        "most_sensitive_match_name": "apikey", "insights": [], "filepath": "src/main/java/org/owasp/wrongsecrets/challenges/docker/Challenge36.java",
        "filename": "Challenge36.java", "presence": "visible", "last_presence_seen_at":
        "2025-10-15T15:58:55.259734Z", "last_presence_check_at": "2025-10-15T15:58:55.259734Z",
        "first_presence_deleted_at": null, "seen_in_default_branch": true, "change_type":
        "addition", "full_tags": [{"type": "FROM_HISTORICAL_SCAN", "metadata": null},
        {"type": "PUBLICLY_EXPOSED", "metadata": null}, {"type": "DEFAULT_BRANCH",
        "metadata": null}]}, "has_dropped_occurrences": false, "tags": ["DEFAULT_BRANCH",
        "FROM_HISTORICAL_SCAN", "PUBLICLY_EXPOSED"], "public_exposure": {"source_publicly_visible":
        true, "public_incident_linked": false, "leaked_outside_perimeter": false},
        "occurrences_count": 8}, {"id": 13327856, "account": 8, "criterion": "Generic
        High Entropy Secret", "date": "2021-10-08T14:05:23Z", "last_trigger_published_at":
        "2021-10-08T14:05:23Z", "last_triggered_at": "2024-08-06T12:10:41.581974Z",
        "last_trigger_detected_at": "2024-08-06T12:10:41.581974Z", "hash": "GOtzevCP+tP3WpMB1YVSK50e6agS1H7uGRcfTLcRQEzkh9/Jp+KkPCNpyNbtXqJM",
        "policy": 1, "ignored": false, "ignored_at": null, "ignore_reason": null,
        "ignorer": null, "resolved": false, "resolved_at": null, "resolver": null,
        "regression": false, "manual_severity_setter": null, "policy_name": "ensure_no_secrets",
        "policy_display_name": "Secrets detection", "ignorer_display_name": "none",
        "ignorer_type": "none", "resolver_display_name": "none", "resolver_type":
        "none", "manual_severity_setter_display_name": "none", "manual_severity_setter_type":
        "none", "status": "TRIGGERED", "issue_name": "Express.js Cryptographic key",
        "severity_rule_config": null, "declarative_secret_status": null, "assignee":
        null, "last_presence_check_at": null, "secret": "[REDACTED]", "severity":
        100, "authors": [{"info": "ziad.ghalleb@gitguardian.com", "name": "ziadghalleb"}],
        "user_permission": 7, "is_publicly_shared": false, "feedbacks_count": 0, "occurrences_presence_seen_count":
        4, "occurrences_presence_deleted_count": 0, "occurrences_presence_should_be_checked":
        null, "locations_count": 0, "sources": [{"name": "Ziad Ghalleb / sample_secrets",
        "type": "gl_project", "path": "zghalleb/sample_secrets", "source_criticality":
        "unknown"}], "custom_tags": [{"id": "54697103-1a85-4f35-8766-6cf16399f83e",
        "key": "linked incident", "value": null}], "vault_metadata": [{"source": "hashicorpvault"}],
        "is_vaulted": true, "similar_issue_count": 0, "score": 34, "displayed_occurrence":
        {"id": 162504542, "issue": 13327856, "account": 8, "kind": "HIST", "element":
        "9c7a32a32e0c7f550aecddae5fb1cc56a99e4819", "element_type": "GIT_COMMIT",
        "author_name": "ziadghalleb", "author_info": "ziad.ghalleb@gitguardian.com",
        "value": null, "value_hash": "TwTuzSuZqTajz3LCKkpqlNNR6W0WkVMYOTzlfGmpucsNnMDWcMFKWuEE8Fzo6JJh",
        "published_at": "2021-10-08T14:05:23Z", "date": "2021-10-08T14:05:23Z", "detected_at":
        "2024-08-06T12:10:40.211023Z", "is_vcs_type": true, "last_detected_at": "2021-10-08T14:05:23Z",
        "last_seen_at": "2021-10-08T14:05:23Z", "data": {}, "url": "https://gitlab-01.aws-qa-gitguardian.com/zghalleb/sample_secrets/commit/9c7a32a32e0c7f550aecddae5fb1cc56a99e4819#13efba5ad0b625860b127483153a71003c0c4dde_8_15",
        "source": {"id": 16219029, "url": "https://gitlab-01.aws-qa-gitguardian.com/zghalleb/sample_secrets",
        "type": "gl_project", "display_name": "Ziad Ghalleb / sample_secrets", "visibility":
        "public", "monitored": true, "source_criticality": "unknown", "deleted_at":
        null, "default_branch": "main"}, "regression": false, "content": 42074215,
        "secrets_engine_version": "2.117.0", "matches": [{"name": "apikey", "string_matched":
        "[REDACTED]", "indice_start": 365, "indice_end": 385, "pre_line_start": null,
        "pre_line_end": null, "post_line_start": 15, "post_line_end": 15}], "most_sensitive_match_name":
        "apikey", "insights": [], "filepath": "postgres_model.js", "filename": "postgres_model.js",
        "presence": "visible", "last_presence_seen_at": "2025-10-24T13:59:13.519528Z",
        "last_presence_check_at": "2025-10-24T13:59:13.519528Z", "first_presence_deleted_at":
        null, "seen_in_default_branch": true, "change_type": "addition", "full_tags":
        [{"type": "FROM_HISTORICAL_SCAN", "metadata": null}, {"type": "DEFAULT_BRANCH",
        "metadata": null}]}, "has_dropped_occurrences": false, "tags": ["DEFAULT_BRANCH",
        "FROM_HISTORICAL_SCAN"], "public_exposure": {"source_publicly_visible": false,
        "public_incident_linked": false, "leaked_outside_perimeter": false}, "occurrences_count":
        4}]}'
    headers:
      access-control-expose-headers:
      - X-App-Version
      allow:
      - GET, HEAD, OPTIONS
      content-length:
      - '21339'
      content-security-policy:
      - frame-ancestors 'none'
      content-type:
      - application/json
      cross-origin-opener-policy:
      - same-origin
      date:
      - Thu, 05 Feb 2026 08:02:16 GMT
      referrer-policy:
      - strict-origin-when-cross-origin
      server:
      - istio-envoy
      strict-transport-security:
      - max-age=31536000; includeSubDomains
      vary:
      - Cookie
      x-app-version:
      - v2.384.0
      x-content-type-options:
      - nosniff
      x-envoy-upstream-service-time:
      - '537'
      x-frame-options:
      - DENY
      x-secrets-engine-version:
      - 2.155.4
      x-xss-protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
version: 1
